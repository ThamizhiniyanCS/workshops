import pefile

pe = pefile.PE("calc.exe")

if hasattr(pe, 'DIRECTORY_ENTRY_IMPORT'):
    for each in pe.DIRECTORY_ENTRY_IMPORT:
        print(f'$ {str(each.dll, "utf-8")}')
        for some in each.imports:
            if some.name:
                print(f'\t|- {str(some.name, "utf-8")}')
            else:
                print(f'\t|- Ordinal: {some.ordinal}')