#! /usr/bin/python3

import vt

client = vt.Client("<apikey>")

# Get information about a file
# Ask for the file you are interested in, you can replace the hash in the example with some other SHA-256, SHA-1 or MD5
file = client.get_object("/files/9b66a8ea0f1c64965b06e7a45afbe56f2d4e6d5ef65f32446defccbebe730813")
print(file.last_analysis_stats)

# Get information about an URL
url_id = vt.url_id("http://testphp.vulnweb.com/")
url = client.get_object(f"/urls/{url_id}")
print(url.last_analysis_stats)
print(url.first_submission_date, url.last_submission_date)

# Scan a file
with open("calc.exe", 'rb') as file:
    analysis = client.scan_file(file, wait_for_completion=True)
    print(analysis.stats)

# Scan a URL
url_analysis = client.scan_url('http://testphp.vulnweb.com/')
print(url_analysis)

client.close()