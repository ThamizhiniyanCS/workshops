import sys
import pefile


def main():
    if len(sys.argv) < 2:
        print("Usage: python script.py <path_to_pe_file>")
        sys.exit(1)

    pe_file = sys.argv[1]
    pe = pefile.PE(pe_file)

    print(
        f"| {'Section Name'.center(16)} | {'MD5'.center(34)} | {'SHA256'.center(66)} |"
    )
    print(f"|{'-'*18}|{'-'*36}|{'-'*68}|")

    for section in pe.sections:
        section_name = section.Name.decode("utf-8").strip("\x00")
        md5_hash = section.get_hash_md5()
        sha256_hash = section.get_hash_sha256()
        print(
            f"| {section_name.center(16)} | {md5_hash.center(34)} | {sha256_hash.center(66)} |"
        )


if __name__ == "__main__":
    main()