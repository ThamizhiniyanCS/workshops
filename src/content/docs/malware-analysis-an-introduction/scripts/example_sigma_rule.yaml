title: Suspicious PowerShell Command
id: a6b56c9f-e007-4c54-b7e5-8f4adf7ccf12
status: experimental
description: Detects execution of suspicious PowerShell commands, such as those used for downloading files from the internet.
author: Your Name
date: 2025-01-03
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    Image|endswith: '\powershell.exe'
    CommandLine|contains:
      - "Invoke-WebRequest"
      - "DownloadString"
  condition: selection
fields:
  - Image
  - CommandLine
level: high
tags:
  - attack.execution
  - attack.t1059.001